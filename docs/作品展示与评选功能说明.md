# 作品展示与评选功能说明

## 功能概述

作品展示与评选系统是创作竞赛平台的核心功能模块，提供完整的作品浏览、投票、评选和获奖展示功能。

## 主要功能

### 1. 作品浏览功能 ✅

#### 竞赛选择
- **下拉选择器**：用户可以选择不同的竞赛查看对应作品
- **URL参数支持**：从竞赛页面点击"查看作品"自动跳转到对应竞赛
- **实时更新**：切换竞赛后自动加载对应作品列表

#### 多维度筛选
- **排序方式**：
  - 投票数（高→低）- 默认按人气排序
  - 提交时间（新→旧）- 查看最新作品
  - 浏览量（高→低）- 查看热门作品
  
- **作品分类**：
  - 全部、散文、诗歌、论文、手绘、摄影、其他
  - 支持单一分类筛选
  
- **精选筛选**：
  - 仅显示管理员标记的精选作品
  - 勾选复选框快速筛选

#### 作品卡片展示
- **完整信息**：标题、作者、分类、提交日期
- **标签系统**：显示作品相关标签
- **内容预览**：展示前150字内容摘要
- **统计数据**：实时显示投票数和浏览量
- **精选标识**：精选作品带有金色边框和"⭐精选作品"标记

### 2. 投票功能 ✅

#### 投票规则
- **登录要求**：必须登录才能投票
- **单次投票**：每个用户对同一作品只能投票一次
- **不可自投**：作者无法给自己的作品投票
- **实时更新**：投票后立即更新票数显示

#### 投票操作
- **投票按钮**：
  - 未投票：蓝色"👍 投票"按钮
  - 已投票：绿色"✅ 已投票"按钮
  - 不可投票：灰色"🚫 不可投票"按钮（作者本人）

#### 取消投票 ✅
- **支持撤回**：用户可以取消已投的票
- **确认提示**：取消前需要用户确认
- **即时生效**：取消后票数立即减少

### 3. 排名与获奖展示 ✅

#### 人气排行榜
- **TOP 10展示**：专门的"人气TOP10"标签页
- **排名徽章**：
  - 第1名：🥇 金牌（金色圆形徽章）
  - 第2名：🥈 银牌（银色圆形徽章）
  - 第3名：🥉 铜牌（铜色圆形徽章）
  - 第4-10名：数字排名徽章

#### 获奖作品区
- **独立展示区**：页面顶部显著位置
- **三甲展示**：
  - 一等奖（第1名）
  - 二等奖（第2名）
  - 三等奖（第3名）
- **奖项卡片**：包含奖牌、奖项名称、作品标题、作者、票数等信息
- **快速查看**：点击可直接查看获奖作品详情

### 4. 作品详情查看 ✅

#### 详情弹窗
- **完整内容**：显示作品全文
- **元数据**：作者、分类、提交日期、标签
- **统计信息**：投票数、浏览量（自动+1）
- **互动操作**：可直接在详情页投票或取消投票

#### 浏览量统计
- **自动计数**：每次查看详情浏览量+1
- **持久化存储**：浏览量保存到数据库

### 5. 管理员功能 ✅

#### 精选作品
- **设置精选**：管理员可标记优秀作品为精选
- **取消精选**：可随时取消精选状态
- **视觉区分**：
  - 金色边框
  - "⭐ 精选作品"标记
  - 精选筛选功能

## 技术实现

### 前端页面
- **contest_works.html**：作品展示页面
  - 响应式布局
  - 卡片式展示
  - 模态弹窗详情

- **contest_works.js**：业务逻辑
  - ContestWorksApp类封装
  - 异步数据加载
  - 投票/取消投票处理
  - 筛选排序功能

### 后端API

#### GET `/api/contests/:contestId/submissions`
- **功能**：获取竞赛的所有作品
- **参数**：
  - sort: 排序方式（votes/time/views）
  - category: 分类筛选
- **返回**：作品列表

#### GET `/api/submissions/:id`
- **功能**：获取作品详情
- **副作用**：浏览量+1
- **返回**：作品完整信息

#### POST `/api/contests/vote`
- **功能**：投票
- **认证**：需要登录
- **校验**：
  - 是否已投票
  - 是否为本人作品
- **返回**：新的票数

#### POST `/api/contests/unvote` ✅ 新增
- **功能**：取消投票
- **认证**：需要登录
- **校验**：是否已投票
- **返回**：新的票数

#### POST `/api/submissions/:id/feature`
- **功能**：设置/取消精选
- **权限**：仅管理员
- **返回**：更新后的作品信息

### 数据存储
- **submissions.json**：作品数据
  ```json
  {
    "id": "作品ID",
    "contestId": "竞赛ID",
    "author": "作者",
    "title": "标题",
    "content": "内容",
    "category": "分类",
    "tags": ["标签1", "标签2"],
    "votes": 投票数,
    "voters": ["投票用户1", "投票用户2"],
    "views": 浏览量,
    "featured": 是否精选,
    "createdAt": "创建时间"
  }
  ```

## 用户体验

### 视觉设计
- **渐变色系**：紫色主题（#667eea → #764ba2）
- **动画效果**：卡片悬停、按钮交互
- **响应式布局**：适配手机、平板、桌面

### 交互设计
- **一键操作**：投票、取消投票仅需点击
- **实时反馈**：操作后立即更新UI
- **友好提示**：操作成功/失败的明确提示
- **状态区分**：不同状态按钮有不同颜色和图标

### 信息架构
- **清晰导航**：竞赛选择 → 作品列表 → 作品详情
- **多入口访问**：
  - 主导航栏"作品展示"
  - 竞赛页面"查看作品"按钮
- **数据统计**：标签页显示作品数量

## 使用场景

### 普通用户
1. 进入作品展示页面
2. 选择感兴趣的竞赛
3. 浏览作品列表
4. 点击查看详情
5. 为优秀作品投票
6. 查看人气TOP10

### 管理员
1. 审查所有作品
2. 标记优秀作品为精选
3. 查看投票统计
4. 确定获奖名单

### 作者
1. 查看自己的作品
2. 查看作品票数和浏览量
3. 对比其他作品
4. 了解排名情况

## 数据安全

### 权限控制
- ✅ 投票需要登录认证
- ✅ 防止重复投票（voters数组）
- ✅ 作者无法自投
- ✅ 精选功能仅管理员可用

### 数据校验
- ✅ 后端验证用户身份
- ✅ 检查作品是否存在
- ✅ 验证投票状态
- ✅ 防止票数异常（取消投票不会为负）

## 未来扩展

### 潜在功能
- 🔜 评论功能
- 🔜 分享功能
- 🔜 收藏功能
- 🔜 多轮投票
- 🔜 投票时间限制
- 🔜 投票数据可视化
- 🔜 获奖证书生成

## 总结

作品展示与评选系统提供了完整的作品浏览、投票、评选功能，支持多维度筛选、实时排名、获奖展示等特性，确保公平公正的评选机制，为创作竞赛提供了强大的支撑。
