<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªäººä¸­å¿ƒ - ä»¥å²ä¸ºé‰´ï¼Œå‡èšåŠ›é‡</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
        }
        
        .profile-header {
            background: linear-gradient(135deg, #fff5f5, #fde7e7);
            border-radius: var(--radius);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #c62828, #e53935);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 60px;
            color: white;
            box-shadow: var(--shadow-lg);
        }
        
        .profile-name {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .profile-role {
            font-size: 18px;
            color: var(--muted);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid #c62828;
        }
        
        .stat-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--muted);
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #c62828;
        }
        
        .achievements-section {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .achievement-badge {
            background: rgba(198, 40, 40, 0.1);
            border: 2px solid #ddd;
            border-radius: var(--radius);
            padding: 15px;
            text-align: center;
            transition: var(--transition);
        }
        
        .achievement-badge.unlocked {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(198, 40, 40, 0.2));
            border-color: #ffd700;
        }
        
        .achievement-badge:hover {
            transform: scale(1.05);
        }
        
        .achievement-badge .icon {
            font-size: 40px;
            filter: grayscale(100%);
        }
        
        .achievement-badge.unlocked .icon {
            filter: grayscale(0%);
        }
        
        .achievement-badge .name {
            font-weight: bold;
            margin-top: 8px;
            font-size: 14px;
        }
        
        .achievement-badge .desc {
            font-size: 12px;
            color: var(--muted);
            margin-top: 4px;
        }
        
        .difficulty-stats {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .difficulty-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(198, 40, 40, 0.05);
            border-radius: 8px;
            border-left: 4px solid #c62828;
        }
        
        .difficulty-name {
            font-size: 18px;
            font-weight: bold;
        }
        
        .difficulty-score {
            font-size: 20px;
            color: #c62828;
            font-weight: bold;
        }
        
        .back-link {
            display: inline-block;
            padding: 12px 24px;
            background: #c62828;
            color: white;
            border-radius: var(--radius);
            text-decoration: none;
            transition: var(--transition);
            margin-top: 20px;
        }
        
        .back-link:hover {
            background: #e53935;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: var(--muted);
            font-size: 16px;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="wrap">
            <h1>ğŸ›ï¸ ä¸ªäººä¸­å¿ƒ</h1>
            <nav class="main-nav">
                <a href="index.html">é¦–é¡µ</a>
                <a href="game.html">è¿”å›æ¸¸æˆ</a>
            </nav>
        </div>
    </header>

    <div class="wrap profile-container">
        <div class="profile-header">
            <div class="profile-avatar">
                <span id="user-avatar">ğŸ‘¤</span>
            </div>
            <div class="profile-name" id="user-name">æ¸¸å®¢</div>
            <div class="profile-role" id="user-role">æ™®é€šç”¨æˆ·</div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ®</div>
                <div class="stat-label">æ¸¸æˆæ€»å±€æ•°</div>
                <div class="stat-value" id="games-played">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â­</div>
                <div class="stat-label">ç´¯è®¡æ€»å¾—åˆ†</div>
                <div class="stat-value" id="total-score">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ†</div>
                <div class="stat-label">æœ€é«˜å¾—åˆ†</div>
                <div class="stat-value" id="best-score">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ¯</div>
                <div class="stat-label">æˆå°±è§£é”</div>
                <div class="stat-value" id="achievements-count">0/11</div>
            </div>
        </div>

        <div class="difficulty-stats">
            <div class="section-title">
                <span>ğŸ“Š</span>
                <span>å„éš¾åº¦æœ€ä½³æˆç»©</span>
            </div>
            <div class="difficulty-row">
                <div class="difficulty-name">ğŸŒŸ ç®€å•æ¨¡å¼</div>
                <div class="difficulty-score" id="easy-best">0 åˆ†</div>
            </div>
            <div class="difficulty-row">
                <div class="difficulty-name">âš¡ æ™®é€šæ¨¡å¼</div>
                <div class="difficulty-score" id="normal-best">0 åˆ†</div>
            </div>
            <div class="difficulty-row">
                <div class="difficulty-name">ğŸ”¥ å›°éš¾æ¨¡å¼</div>
                <div class="difficulty-score" id="hard-best">0 åˆ†</div>
            </div>
        </div>

        <div class="achievements-section">
            <div class="section-title">
                <span>ğŸ…</span>
                <span>æˆå°±å¾½ç« </span>
            </div>
            <div class="achievement-grid" id="achievements-display">
                <!-- æˆå°±å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <div style="text-align: center;">
            <a href="game.html" class="back-link">ğŸ¯ å¼€å§‹æ¸¸æˆ</a>
            <a href="index.html" class="back-link" style="background: #666; margin-left: 10px;">ğŸ  è¿”å›é¦–é¡µ</a>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        // åŠ è½½ç”¨æˆ·ä¿¡æ¯
        function loadUserProfile() {
            const userName = localStorage.getItem('login_user') || 'æ¸¸å®¢';
            const userRole = localStorage.getItem('login_role') || 'user';

            document.getElementById('user-name').textContent = userName;
            document.getElementById('user-role').textContent = userRole === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·';

            // è®¾ç½®å¤´åƒ
            const avatar = userName.charAt(0).toUpperCase();
            document.getElementById('user-avatar').textContent = avatar;
        }

        // åŠ è½½æ¸¸æˆç»Ÿè®¡æ•°æ®
        function loadGameStats() {
            const stats = localStorage.getItem('gameStats');
            const gameStats = stats ? JSON.parse(stats) : {
                gamesPlayed: 0,
                totalScore: 0
            };

            document.getElementById('games-played').textContent = gameStats.gamesPlayed || 0;
            document.getElementById('total-score').textContent = gameStats.totalScore || 0;
        }

        // åŠ è½½æœ€é«˜åˆ†å’Œéš¾åº¦ç»Ÿè®¡
        function loadBestScores() {
            const rankings = localStorage.getItem('gameRankings');
            const currentUser = localStorage.getItem('login_user') || 'æ¸¸å®¢';

            if (!rankings) {
                return;
            }

            const allRankings = JSON.parse(rankings);
            const userRankings = allRankings.filter(r => r.name === currentUser);

            if (userRankings.length === 0) {
                return;
            }

            // è®¡ç®—æœ€é«˜åˆ†
            const bestScore = Math.max(...userRankings.map(r => r.score));
            document.getElementById('best-score').textContent = bestScore;

            // æŒ‰éš¾åº¦ç»Ÿè®¡æœ€é«˜åˆ†
            const easyBest = Math.max(0, ...userRankings.filter(r => r.difficulty === 'easy').map(r => r.score));
            const normalBest = Math.max(0, ...userRankings.filter(r => r.difficulty === 'normal').map(r => r.score));
            const hardBest = Math.max(0, ...userRankings.filter(r => r.difficulty === 'hard').map(r => r.score));

            document.getElementById('easy-best').textContent = easyBest + ' åˆ†';
            document.getElementById('normal-best').textContent = normalBest + ' åˆ†';
            document.getElementById('hard-best').textContent = hardBest + ' åˆ†';
        }

        // åŠ è½½æˆå°±æ•°æ®
        function loadAchievements() {
            // æˆå°±å®šä¹‰ï¼ˆä¸æ¸¸æˆä¸­ä¿æŒä¸€è‡´ï¼‰
            const achievementDefs = {
                firstKill: {
                    title: "é¦–æ€å»ºåŠŸ",
                    desc: "å‡»æ€ç¬¬ä¸€ä¸ªæ•Œäºº",
                    icon: "ğŸ¯"
                },
                score50: {
                    title: "æŠ—æˆ˜æ–°å…µ",
                    desc: "è¾¾åˆ°50åˆ†",
                    icon: "ğŸ–ï¸"
                },
                score100: {
                    title: "ä¼˜ç§€æˆ˜å£«",
                    desc: "è¾¾åˆ°100åˆ†",
                    icon: "ğŸ…"
                },
                score200: {
                    title: "æŠ—æˆ˜è‹±é›„",
                    desc: "è¾¾åˆ°200åˆ†",
                    icon: "â­"
                },
                combo3: {
                    title: "ç²¾å‡†å°„å‡»",
                    desc: "è¿æ€3æ¬¡",
                    icon: "ğŸ¯"
                },
                combo5: {
                    title: "ç™¾æ­¥ç©¿æ¨",
                    desc: "è¿æ€5æ¬¡",
                    icon: "ğŸ¹"
                },
                combo10: {
                    title: "ç¥æªæ‰‹",
                    desc: "è¿æ€10æ¬¡",
                    icon: "ğŸ”«"
                },
                survive3min: {
                    title: "åšå®ˆé˜µåœ°",
                    desc: "å­˜æ´»3åˆ†é’Ÿ",
                    icon: "ğŸ›¡ï¸"
                },
                survive5min: {
                    title: "é’¢é“é•¿åŸ",
                    desc: "å­˜æ´»5åˆ†é’Ÿ",
                    icon: "ğŸ°"
                },
                perfectDefense: {
                    title: "å®Œç¾é˜²å®ˆ",
                    desc: "é›¶å¤±è¯¯å‡»æ€20ä¸ªæ•Œäºº",
                    icon: "ğŸ’"
                },
                eventSurvivor: {
                    title: "å†å²è§è¯è€…",
                    desc: "å®Œæˆä¸€æ¬¡å†å²äº‹ä»¶",
                    icon: "ğŸ“œ"
                }
            };

            // ä» localStorage è¯»å–æˆå°±çŠ¶æ€ï¼ˆå‡è®¾æ¸¸æˆä¼šä¿å­˜ï¼‰
            // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œé»˜è®¤æ‰€æœ‰æˆå°±æœªè§£é”
            const achievementsDisplay = document.getElementById('achievements-display');
            achievementsDisplay.innerHTML = '';

            let unlockedCount = 0;

            for (let key in achievementDefs) {
                const ach = achievementDefs[key];
                const isUnlocked = false; // å®é™…åº”è¯¥ä» localStorage è¯»å–

                const badge = document.createElement('div');
                badge.className = 'achievement-badge' + (isUnlocked ? ' unlocked' : '');
                badge.innerHTML = `
                    <div class="icon">${ach.icon}</div>
                    <div class="name">${ach.title}</div>
                    <div class="desc">${ach.desc}</div>
                `;

                achievementsDisplay.appendChild(badge);

                if (isUnlocked) unlockedCount++;
            }

            document.getElementById('achievements-count').textContent = `${unlockedCount}/${Object.keys(achievementDefs).length}`;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', () => {
            loadUserProfile();
            loadGameStats();
            loadBestScores();
            loadAchievements();
        });
    </script>
</body>

</html>